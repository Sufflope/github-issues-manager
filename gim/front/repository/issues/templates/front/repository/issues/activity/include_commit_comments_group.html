{% load frontutils macros %}
{% macro render_user user with_count %}<strong><img class="avatar-tiny img-circle" src="{{ user.full_avatar_url }}"> {{ user.username }}</strong>{% if with_count %} ({{ user.count }}){% endif %}{% endmacro %}
<li>
    <div class="box commit-comments-group">
        {% with nb_comments=group|length %}
            <div class="box-header">
                <span class="fa-stack">
                    <i class="fa fa-comment-o fa-stack-2x"></i>
                    <i class="fa fa-code fa-stack-1x"></i>
                </span>
                <div class="title">
                    {{ nb_comments }} commit comment{{ nb_comments|pluralize }} {{ nb_comments|pluralize:'was,were'}} added on a commit
                </div>
                <ul class="box-toolbar">
                    <li class="time" title="{{ group.start_date|date:"DATE_FORMAT" }}"><i class="fa fa-clock-o"></i> {% if with_ago %}{{ group.start_date|ago }}{% else %}{{ group.start_date|date:"DATE_FORMAT" }}{% endif %}</li>
                </ul>
            </div>
            <div class="box-content">
                by
                {% if group.authors|length == 1 %}
                    {% usemacro render_user group.authors.values.0 False %}
                {% else %}
                    {% usemacro render_user group.authors.values.0 True %}<!--
                    {% for author in group.authors.keys|slice:'1:-1' %}
                        -->, {% usemacro render_user group.authors|dict_item:author True %}<!--
                    {% endfor %}
                    --> and {% usemacro render_user group.authors.values|last True %}
                {% endif %}
                <div class="comment-commits">
                    {% include "front/repository/issues/commits/include_commits.html" with commits=group.0.commit|tolist id_prefix="commit-comment-" repository_source=group.0.repository %}
                </div>
            </div>
        {% endwith %}
    </div>
</li>
